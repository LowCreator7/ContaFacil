Você disse:
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Compras</title>
  <link rel="stylesheet" href="estilo.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

  <aside class="sidebar">
    <h2>🛒 Compras</h2>
    <nav>
      <a href="perfil.html">🙍 Meu Perfil</a>
      <a href="dashboard.html">🏠 Dashboard</a>
      <a href="compras.html" class="active">🛒 Compras</a>
      <a href="vendas.html">💰 Vendas</a>
      <a href="produtos.html">📄 Produtos</a>
      <a href="clientes.html">👤 Clientes</a>
      <a href="fornecedores.html">🏭 Fornecedores</a>
      <a href="contas-receber-simples.html">📥 Contas a Receber</a>
      <a href="contas-pagar.html">📤 Contas a Pagar</a>
      <a href="despesas.html">💸 Despesas</a>
      <a href="estoque.html">📦 Estoque</a>
      <a href="dre.html">📊 DRE</a>
    </nav>
  </aside>

  <main class="main">
  <h2>Registro de Compras</h2>

  <form id="formCompras">
    <input type="date" id="data" required>
    
    <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
      <select id="fornecedorSelect" required></select>
      <button type="button" onclick="abrirModalFornecedor()">+ Novo Fornecedor</button>
    </div>
    
    <input type="text" id="produto" placeholder="Produto" required>
    <input type="number" id="quantidade" placeholder="Quantidade" required>
    <input type="number" id="valor" placeholder="Valor Unitário (R$)" required>
    <input type="number" id="porcentagemLucro" placeholder="% Lucro Sugerido">
    <select id="pagamento" required>
      <option value="avista">À vista</option>
      <option value="aprazo">A prazo</option>
    </select>
    <input type="number" id="parcelas" placeholder="Parcelas (se a prazo)" style="display:none;">
    <button type="submit">Salvar</button>
  </form>

  <!-- Modal de Fornecedor -->
  <div id="modalFornecedor" style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%); background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.2); z-index:999;">
    <h3>Novo Fornecedor</h3>
    <input type="text" id="novoFornecedorNome" placeholder="Nome" />
    <input type="text" id="novoFornecedorTelefone" placeholder="Telefone" />
    <br><br>
    <button onclick="salvarNovoFornecedor()">Salvar</button>
    <button onclick="fecharModalFornecedor()">Cancelar</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Data</th>
        <th>Fornecedor</th>
        <th>Produto</th>
        <th>Qtd</th>
        <th>Valor Unit.</th>
        <th>Total</th>
        <th>Pagamento</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody id="tabelaCompras"></tbody>
  </table>
</main>

<script type="module">
  import { auth } from './firebaseConfig.js';
  import {
    carregarDoFirestore,
    salvarNoFirestore,
    atualizarNoFirestore,
    removerDoFirestore
  } from './script-firebase.js';

  const form = document.getElementById("formCompras");
  const tabela = document.getElementById("tabelaCompras");
  const selectPagamento = document.getElementById("pagamento");
  const inputParcelas = document.getElementById("parcelas");
  const fornecedorSelect = document.getElementById("fornecedorSelect");

  let compras = [];
  let editandoId = null;

  selectPagamento.addEventListener("change", () => {
    inputParcelas.style.display = selectPagamento.value === "aprazo" ? "inline" : "none";
  });

  function formatarDataBR(dataISO) {
    return new Date(dataISO).toLocaleDateString('pt-BR');
  }

  function gerarParcelas(valorTotal, numParcelas, dataCompra) {
    const parcelas = [];
    const valorParcela = parseFloat((valorTotal / numParcelas).toFixed(2));
    for (let i = 0; i < numParcelas; i++) {
      const vencimento = new Date(dataCompra);
      vencimento.setMonth(vencimento.getMonth() + i + 1);
      parcelas.push({
        numero: i + 1,
        valor: valorParcela,
        status: 'em aberto',
        vencimento: vencimento.toISOString().split('T')[0]
      });
    }
    return parcelas;
  }

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const userId = auth.currentUser?.uid;
    if (!userId) return alert("Usuário não autenticado.");

    const data = document.getElementById("data").value;
    const fornecedor = fornecedorSelect.value;
    const produto = document.getElementById("produto").value;
    const quantidade = parseInt(document.getElementById("quantidade").value);
    const valor = parseFloat(document.getElementById("valor").value);
    const porcentagemLucro = parseFloat(document.getElementById("porcentagemLucro").value) || 0;
    const pagamento = selectPagamento.value;
    const parcelas = pagamento === "aprazo" ? parseInt(inputParcelas.value) || 1 : 1;

    let compra = {
      userId,
      data,
      fornecedor,
      produto,
      quantidade,
      valor,
      porcentagemLucro,
      pagamento
    };

    if (pagamento === "aprazo") {
      const total = quantidade * valor;
      compra.parcelas = parcelas;
      compra.parcelasDetalhes = gerarParcelas(total, parcelas, data);
    }

    if (editandoId) {
      await atualizarNoFirestore("compras", editandoId, compra);
      editandoId = null;
    } else {
      await salvarNoFirestore("compras", compra);
    }

    form.reset();
    inputParcelas.style.display = "none";
    await carregarCompras();
  });

  async function carregarCompras() {
    const userId = auth.currentUser?.uid;
    compras = (await carregarDoFirestore("compras")).filter(c => c.userId === userId);

    tabela.innerHTML = "";
    compras.forEach(c => {
      const total = c.valor * c.quantidade;
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${formatarDataBR(c.data)}</td>
        <td>${c.fornecedor}</td>
        <td>${c.produto}</td>
        <td>${c.quantidade}</td>
        <td>R$ ${c.valor.toFixed(2)}</td>
        <td>R$ ${total.toFixed(2)}</td>
        <td>${c.pagamento}</td>
        <td>
          <button onclick="editarCompra('${c.id}')">Editar</button>
          <button onclick="excluirCompra('${c.id}')">Excluir</button>
        </td>
      `;
      tabela.appendChild(row);
    });
  }

  window.editarCompra = (id) => {
    const c = compras.find(c => c.id === id);
    if (!c) return;
    document.getElementById("data").value = c.data;
    fornecedorSelect.value = c.fornecedor;
    document.getElementById("produto").value = c.produto;
    document.getElementById("quantidade").value = c.quantidade;
    document.getElementById("valor").value = c.valor;
    document.getElementById("porcentagemLucro").value = c.porcentagemLucro || 0;
    selectPagamento.value = c.pagamento;
    inputParcelas.style.display = c.pagamento === "aprazo" ? "inline" : "none";
    document.getElementById("parcelas").value = c.parcelas || "";
    editandoId = id;
  };

  window.excluirCompra = async (id) => {
    await removerDoFirestore("compras", id);
    await carregarCompras();
  };

  async function atualizarFornecedores() {
    const userId = auth.currentUser?.uid;
    const fornecedores = (await carregarDoFirestore("fornecedores")).filter(f => f.userId === userId);
    fornecedorSelect.innerHTML = '<option value="">Selecione um fornecedor</option>';
    fornecedores.forEach(f => {
      const opt = document.createElement("option");
      opt.value = f.nome;
      opt.textContent = `${f.nome} - ${f.telefone}`;
      fornecedorSelect.appendChild(opt);
    });
  }

  window.abrirModalFornecedor = () => {
    document.getElementById("modalFornecedor").style.display = "block";
  };

  window.fecharModalFornecedor = () => {
    document.getElementById("modalFornecedor").style.display = "none";
    document.getElementById("novoFornecedorNome").value = "";
    document.getElementById("novoFornecedorTelefone").value = "";
  };

  window.salvarNovoFornecedor = async () => {
    const nome = document.getElementById("novoFornecedorNome").value.trim();
    const telefone = document.getElementById("novoFornecedorTelefone").value.trim();
    const userId = auth.currentUser?.uid;

    if (!nome || !telefone) {
      alert("Preencha todos os campos.");
      return;
    }

    await salvarNoFirestore("fornecedores", { nome, telefone, userId });
    await atualizarFornecedores();
    fecharModalFornecedor();
  };

  await atualizarFornecedores();
  await carregarCompras();
</script>
</body>
</html>
